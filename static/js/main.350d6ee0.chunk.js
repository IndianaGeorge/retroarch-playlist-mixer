(this["webpackJsonpretroarch-playlist-mixer"]=this["webpackJsonpretroarch-playlist-mixer"]||[]).push([[0],{19:function(e,t,a){e.exports=a(28)},2:function(e,t,a){e.exports={container:"Game_container__1FRtk",label:"Game_label__3Xfiz",path:"Game_path__3ACC7",crc32:"Game_crc32__26Bi1",dbName:"Game_dbName__slKDc",core:"Game_core__3hxuS",coreName:"Game_coreName__1Af_M",corePath:"Game_corePath__3Riq4"}},24:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),i=a(11),s=a.n(i),r=(a(24),a(5)),c=a(3),o=a.n(c),m=a(18),h=a(8),u=a(12),p=a(13),f=a(4),d=a(14),b=a.n(d),y={version:"1.2",default_core_path:"",default_core_name:"",label_display_mode:0,right_thumbnail_mode:0,left_thumbnail_mode:0,items:[]},_=function(){function e(){Object(u.a)(this,e),this.playlist=null,this.filteredItems=null,this.filename=null,this.nameIndex={},this.crcIndex={},this.pathIndex={},this.playlistEvents=new f.a,this.filteredItemsEvents=new f.a,this.filenameEvents=new f.a}return Object(p.a)(e,[{key:"getPlaylistEvents",value:function(){return this.playlistEvents}},{key:"getfilteredItemsEvents",value:function(){return this.filteredItemsEvents}},{key:"getFilenameEvents",value:function(){return this.filenameEvents}},{key:"getEmptyPlaylist",value:function(){return JSON.parse(JSON.stringify(y))}},{key:"exportPlaylist",value:function(){if(console.log("export called"),this.playlist){var e=JSON.stringify(this.playlist,null,2),t=new Blob([e],{type:"text/plain;charset=utf-8"});b.a.saveAs(t,this.filename)}}},{key:"tokenize",value:function(e){return Object(h.a)(new Set(e.toLowerCase().match(/[a-z0-9]+/g).map((function(e){return e.split("").map((function(t,a){return e.slice(a)})).map((function(e){return e.split("").map((function(t,a){return e.slice(0,a+1)}))}))})).flat(2)))}},{key:"storeInRefs",value:function(e,t,a){t.forEach((function(t){return e[t]?e[t].push(a.index):e[t]=[a.index]}))}},{key:"indexSingle",value:function(e){if(e.game.label&&this.storeInRefs(this.nameIndex,this.tokenize(e.game.label),e),e.game.crc32){var t=e.game.crc32.toLowerCase().match(/^[a-z0-9]+/);t.length>0&&this.storeInRefs(this.crcIndex,this.tokenize(t[0]),e)}e.game.path&&e.game.path.length>0&&(this.storeInRefs(this.pathIndex,this.tokenize(e.game.path),e),this.storeInRefs(this.filenameIndex,this.tokenize(e.game.path.match(/([^\\#]+)\....$/)[1]),e))}},{key:"index",value:function(){var e=this;this.playlist&&this.playlist.items&&(this.clearIndexes(),this.allItems=this.playlist.items.map((function(e,t){return{index:t,game:e}})),this.allItems.forEach((function(t){return e.indexSingle(t)})))}},{key:"clearIndexes",value:function(){this.nameIndex={},this.crcIndex={},this.pathIndex={},this.filenameIndex={},this.allItems=[]}},{key:"applyFilter",value:function(e,t){var a=this;this.filteredItems=[],t.forEach((function(t){e[t]&&(a.filteredItems.length>0?a.filteredItems=a.filteredItems.filter((function(a){return e[t].filter((function(e){return a===e})).length>0})):a.filteredItems=Object(h.a)(e[t]))})),this.filteredItems=Object(h.a)(new Set(this.filteredItems)),this.filteredItems=this.filteredItems.map((function(e){return a.allItems[e]}))}},{key:"filter",value:function(e,t){var a=t.toLowerCase().match(/[a-z0-9]+/g)||[];if(this.playlist&&this.playlist.items){if(a.length>0)switch(e){case"label":this.applyFilter(this.nameIndex,a);break;case"crc32":this.applyFilter(this.crcIndex,a);break;case"path":this.applyFilter(this.pathIndex,a);break;case"filename":this.applyFilter(this.filenameIndex,a)}else this.filteredItems=Object(h.a)(this.allItems);this.filteredItemsEvents.publish(this.filteredItems)}}},{key:"publish",value:function(){this.filenameEvents.publish(this.filename),this.playlistEvents.publish(this.playlist),this.filteredItemsEvents.publish(this.filteredItems)}},{key:"empty",value:function(){this.playlist=null,this.filteredItems=null,this.filename=null,this.clearIndexes(),this.publish()}},{key:"set",value:function(e,t){this.filename=t,this.playlist=JSON.parse(JSON.stringify(e)),this.index(),this.filter("label",""),this.publish()}},{key:"add",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist));var t=Object(m.a)({},e),a={index:this.playlist.items.length,game:t};this.allItems.push(a),this.playlist.items.push(t),this.indexSingle(a),this.filter("label",""),this.publish()}},{key:"delete",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist)),this.playlist.items.splice(e,1),this.index(),this.filter("label",""),this.publish()}}]),e}(),v=Object(l.createContext)(new _),g=Object(l.createContext)(new _),x=a(17),E=a(16),I=a(6),k=a.n(I),N=a(2),O=a.n(N),j=function(e){var t=e.path,a=e.label,l=e.core_path,i=e.core_name,s=e.crc32,r=e.db_name;return n.a.createElement("div",{className:O.a.container,onClick:e.onClick},n.a.createElement("div",{className:O.a.label},a),n.a.createElement("div",{className:O.a.path},t),n.a.createElement("div",{className:O.a.crc32},s),n.a.createElement("div",{className:O.a.dbName},r),n.a.createElement("div",{className:O.a.core},n.a.createElement("div",{className:O.a.coreName},"".concat(i,": ")),n.a.createElement("div",{className:O.a.corePath},l)))},w=function(e){var t=Object(l.useContext)(e.controller),a=Object(f.b)(null,t.getfilteredItemsEvents()),i=Object(r.a)(a,1)[0],s=Object(f.b)(null,t.getFilenameEvents()),c=Object(r.a)(s,1)[0],o=Object(l.useState)(!1),m=Object(r.a)(o,2),h=m[0],u=m[1],p=Object(l.useCallback)((function(e){if(e&&e.length>0){u(!0);var a=e[0],l=new FileReader;l.onabort=function(){return console.log("file reading was aborted")},l.onerror=function(){return console.log("file reading has failed")},l.onload=function(){var e=l.result;t.set(JSON.parse(e),a.path),u(!1)},l.readAsText(a)}}),[t]),d=Object(x.a)({onDrop:p}),b=d.getRootProps,y=d.getInputProps;return n.a.createElement("div",{className:"".concat(e.className?e.className+" ":"").concat(k.a.wrap)},n.a.createElement("div",{className:k.a.filename},c),n.a.createElement(E.a,{className:k.a.content,loading:h},i?i.map((function(t){return n.a.createElement(j,{onClick:function(){return e.onGameClick(t.game,t.index)},key:t.index,path:t.game.path,label:t.game.label,core_path:t.game.core_path,core_name:t.game.core_name,crc32:t.game.crc32,db_name:t.game.db_names})})):n.a.createElement("div",Object.assign({},b(),{className:k.a.dropzone}),n.a.createElement("input",y()),n.a.createElement("div",{className:k.a.dropzoneTitle},"Drop playlist here!"))),n.a.createElement("div",{className:k.a.buttonPanel},Object.keys(e.buttons).map((function(t){return n.a.createElement("button",{key:t,onClick:e.buttons[t]},t)}))))},P=function(){var e=Object(l.useContext)(v),t=Object(l.useContext)(g),a=Object(l.useState)(""),i=Object(r.a)(a,2),s=i[0],c=i[1],m=Object(l.useState)("label"),h=Object(r.a)(m,2),u=h[0],p=h[1],f=function(a,l){e.filter(a,l),t.filter(a,l)},d={Reset:e.empty.bind(e),"Copy all":function(){e.playlist&&(e.playlist.items.forEach((function(e){t.add(e)})),t.filter(u,s))}},b={Reset:t.empty.bind(t),New:function(){t.set(t.getEmptyPlaylist(),"New Retroarch playlist.lpl")},Export:t.exportPlaylist.bind(t)};return n.a.createElement("div",{className:o.a.App},n.a.createElement("header",{className:o.a.header},n.a.createElement("h1",{className:o.a.title},"Retroarch playlist mixer")),n.a.createElement("div",{className:o.a.playlistPanel},n.a.createElement(w,{controller:v,onGameClick:function(e,a){t.playlist&&(t.add(e),t.filter(u,s))},buttons:d}),n.a.createElement(w,{controller:g,onGameClick:function(e,a){t.delete(a),t.filter(u,s)},buttons:b})),n.a.createElement("div",{className:o.a.textPanel},n.a.createElement("div",{className:o.a.filter},n.a.createElement("input",{onChange:function(e){c(e.target.value),f(u,e.target.value)},value:s,className:o.a.filterText}),n.a.createElement("select",{value:u,onChange:function(e){p(e.target.value),""!==s&&f(e.target.value,s)}},n.a.createElement("option",{value:"label"},"Label"),n.a.createElement("option",{value:"filename"},"Filename"),n.a.createElement("option",{value:"crc32"},"CRC32"),n.a.createElement("option",{value:"path"},"Full path")),n.a.createElement("button",{onClick:function(){c(""),f(u,"")}},"clear")),n.a.createElement("textarea",{rows:"6",disabled:!0,value:"console"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},3:function(e,t,a){e.exports={title:"App_title__1Eui0",App:"App_App__3xJ5q",header:"App_header__1FxIt",playlistPanel:"App_playlistPanel__fAtzO",textPanel:"App_textPanel__1ksXY",filter:"App_filter__2rpJO",filterText:"App_filterText__rjA92"}},6:function(e,t,a){e.exports={wrap:"Playlist_wrap__25CD4",content:"Playlist_content__3q2tv",buttonPanel:"Playlist_buttonPanel__1XzPe",filename:"Playlist_filename__3TaF-",dropzone:"Playlist_dropzone__3jSaX",dropzoneTitle:"Playlist_dropzoneTitle__MvR8x"}}},[[19,1,2]]]);
//# sourceMappingURL=main.350d6ee0.chunk.js.map