(this["webpackJsonpretroarch-playlist-mixer"]=this["webpackJsonpretroarch-playlist-mixer"]||[]).push([[0],{19:function(e,t,a){e.exports=a(28)},24:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),i=a(12),c=a.n(i),r=(a(24),a(8)),s=a(2),o=a(4),u=a.n(o),h=a(9),m=a(13),f=a(14),p=a(5),b=a(15),d=a.n(b),g={version:"1.2",default_core_path:"",default_core_name:"",label_display_mode:0,right_thumbnail_mode:0,left_thumbnail_mode:0,items:[]},v=function(){function e(){Object(m.a)(this,e),this.playlist=null,this.filteredItems=null,this.filename=null,this.nameIndex={},this.crcIndex={},this.pathIndex={},this.playlistEvents=new p.a,this.filteredItemsEvents=new p.a,this.filenameEvents=new p.a}return Object(f.a)(e,[{key:"getPlaylistEvents",value:function(){return this.playlistEvents}},{key:"getfilteredItemsEvents",value:function(){return this.filteredItemsEvents}},{key:"getFilenameEvents",value:function(){return this.filenameEvents}},{key:"getEmptyPlaylist",value:function(){return JSON.parse(JSON.stringify(g))}},{key:"exportPlaylist",value:function(){if(this.playlist){var e=JSON.stringify(this.playlist,null,2),t=new Blob([e],{type:"text/plain;charset=utf-8"});d.a.saveAs(t,this.filename)}}},{key:"tokenize",value:function(e){return Object(h.a)(new Set(e.toLowerCase().match(/[a-z0-9]+/g).map((function(e){return e.split("").map((function(t,a){return e.slice(a)})).map((function(e){return e.split("").map((function(t,a){return e.slice(0,a+1)}))}))})).flat(2)))}},{key:"storeInRefs",value:function(e,t,a){t.forEach((function(t){return e[t]?e[t].push(a.index):e[t]=[a.index]}))}},{key:"indexSingle",value:function(e){if(e.game.label&&(this.storeInRefs(this.nameIndex,this.tokenize(e.game.label),e),this.fullLabel[e.game.label]?this.fullLabel[e.game.label].push(e):this.fullLabel[e.game.label]=[e]),e.game.crc32){var t=e.game.crc32.toLowerCase().match(/^[a-z0-9]+/);t.length>0&&this.storeInRefs(this.crcIndex,this.tokenize(t[0]),e),this.fullCrc[e.game.crc32]?this.fullCrc[e.game.crc32].push(e):this.fullCrc[e.game.crc32]=[e]}if(e.game.path&&e.game.path.length>0){this.storeInRefs(this.pathIndex,this.tokenize(e.game.path),e),this.fullPath[e.game.path]?this.fullPath[e.game.path].push(e):this.fullPath[e.game.path]=[e];var a=e.game.path.match(/([^\\#]+\....)$/)[1];this.storeInRefs(this.filenameIndex,this.tokenize(a),e),this.fullFilename[a]?this.fullFilename[a].push(e):this.fullFilename[a]=[e]}}},{key:"index",value:function(){var e=this;this.playlist&&this.playlist.items&&(this.clearIndexes(),this.allItems=this.playlist.items.map((function(e,t){return{index:t,game:e}})),this.allItems.forEach((function(t){return e.indexSingle(t)})))}},{key:"clearIndexes",value:function(){this.nameIndex={},this.crcIndex={},this.pathIndex={},this.filenameIndex={},this.allItems=[],this.fullLabel={},this.fullCrc={},this.fullPath={},this.fullFilename={}}},{key:"applyFilter",value:function(e,t){var a=this;this.filteredItems=[],t.forEach((function(t){e[t]&&(a.filteredItems.length>0?a.filteredItems=a.filteredItems.filter((function(a){return e[t].filter((function(e){return a===e})).length>0})):a.filteredItems=Object(h.a)(e[t]))})),this.filteredItems=Object(h.a)(new Set(this.filteredItems)),this.filteredItems=this.filteredItems.map((function(e){return a.allItems[e]}))}},{key:"filter",value:function(e,t){var a=t.toLowerCase().match(/[a-z0-9]+/g)||[];if(this.playlist&&this.playlist.items){if(a.length>0)switch(e){case"label":this.applyFilter(this.nameIndex,a);break;case"crc32":this.applyFilter(this.crcIndex,a);break;case"path":this.applyFilter(this.pathIndex,a);break;case"filename":this.applyFilter(this.filenameIndex,a)}else this.filteredItems=Object(h.a)(this.allItems);this.filteredItemsEvents.publish(this.filteredItems)}}},{key:"publish",value:function(){this.filenameEvents.publish(this.filename),this.playlistEvents.publish(this.playlist),this.filteredItemsEvents.publish(this.filteredItems)}},{key:"empty",value:function(){this.playlist=null,this.filteredItems=null,this.filename=null,this.clearIndexes(),this.publish()}},{key:"set",value:function(e,t){this.filename=t,this.playlist=JSON.parse(JSON.stringify(e)),this.index(),this.filter("label",""),this.publish()}},{key:"add",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist));var t=Object(r.a)({},e),a={index:this.playlist.items.length,game:t};this.allItems.push(a),this.playlist.items.push(t),this.indexSingle(a),this.filter("label",""),this.publish()}},{key:"delete",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist)),this.playlist.items.splice(e,1),this.index(),this.filter("label",""),this.publish()}}]),e}(),y=Object(l.createContext)(new v),E=Object(l.createContext)(new v),_=a(18),k=a(17),x=a(6),O=a.n(x),j=a(3),C=a.n(j),I=function(e){var t=e.path,a=e.label,l=e.core_path,i=e.core_name,c=e.crc32,r=e.db_name;return n.a.createElement("div",{className:C.a.container,onClick:e.onClick},n.a.createElement("div",{className:C.a.label},a),n.a.createElement("div",{className:C.a.path},t),n.a.createElement("div",{className:C.a.crc32},c),n.a.createElement("div",{className:C.a.dbName},r),n.a.createElement("div",{className:C.a.core},n.a.createElement("div",{className:C.a.coreName},"".concat(i,": ")),n.a.createElement("div",{className:C.a.corePath},l)))},P=function(e){var t=Object(l.useContext)(e.controller),a=Object(p.b)(null,t.getfilteredItemsEvents()),i=Object(s.a)(a,1)[0],c=Object(p.b)(null,t.getFilenameEvents()),r=Object(s.a)(c,1)[0],o=Object(l.useState)(!1),u=Object(s.a)(o,2),h=u[0],m=u[1],f=Object(l.useCallback)((function(e){if(e&&e.length>0){m(!0);var a=e[0],l=new FileReader;l.onabort=function(){return console.log("file reading was aborted")},l.onerror=function(){return console.log("file reading has failed")},l.onload=function(){var e=l.result;t.set(JSON.parse(e),a.path),m(!1)},l.readAsText(a)}}),[t]),b=Object(_.a)({onDrop:f}),d=b.getRootProps,g=b.getInputProps;return n.a.createElement("div",{className:"".concat(e.className?e.className+" ":"").concat(O.a.wrap)},n.a.createElement("div",{className:O.a.filename},r),n.a.createElement(k.a,{className:O.a.content,loading:h},i?i.map((function(t){return n.a.createElement(I,{onClick:function(){return e.onGameClick(t.game,t.index)},key:t.index,path:t.game.path,label:t.game.label,core_path:t.game.core_path,core_name:t.game.core_name,crc32:t.game.crc32,db_name:t.game.db_names})})):n.a.createElement("div",Object.assign({},d(),{className:O.a.dropzone}),n.a.createElement("input",g()),n.a.createElement("div",{className:O.a.dropzoneTitle},"Drop playlist here!"))),n.a.createElement("div",{className:O.a.buttonPanel},Object.keys(e.buttons).map((function(t){return n.a.createElement("button",{key:t,onClick:e.buttons[t]},t)}))))},S=function(){var e=Object(l.useContext)(y),t=Object(l.useContext)(E),a=Object(l.useState)(""),i=Object(s.a)(a,2),c=i[0],o=i[1],h=Object(l.useState)("label"),m=Object(s.a)(h,2),f=m[0],p=m[1],b=Object(l.useState)(!1),d=Object(s.a)(b,2),g=d[0],v=d[1],_=Object(l.useState)(!1),k=Object(s.a)(_,2),x=k[0],O=k[1],j=Object(l.useState)(!1),C=Object(s.a)(j,2),I=C[0],S=C[1],N=Object(l.useState)("detect"),w=Object(s.a)(N,2),F=w[0],T=w[1],z=Object(l.useState)(""),A=Object(s.a)(z,2),R=A[0],L=A[1],J=Object(l.useState)("C:\\"),D=Object(s.a)(J,2),G=D[0],$=D[1],B=Object(l.useState)(!1),M=Object(s.a)(B,2),W=M[0],X=M[1],q=Object(l.useState)(!1),K=Object(s.a)(q,2),Y=K[0],H=K[1],Q=Object(l.useState)(!1),U=Object(s.a)(Q,2),V=U[0],Z=U[1],ee=Object(l.useState)(!1),te=Object(s.a)(ee,2),ae=te[0],le=te[1],ne=Object(l.useState)("detect"),ie=Object(s.a)(ne,2),ce=ie[0],re=ie[1],se=Object(l.useState)("label"),oe=Object(s.a)(se,2),ue=oe[0],he=oe[1],me=Object(l.useState)(""),fe=Object(s.a)(me,2),pe=fe[0],be=fe[1],de=Object(l.useState)(!1),ge=Object(s.a)(de,2),ve=ge[0],ye=ge[1],Ee=Object(l.useState)("(fixed)"),_e=Object(s.a)(Ee,2),ke=_e[0],xe=_e[1],Oe=Object(l.useState)("C:\\"),je=Object(s.a)(Oe,2),Ce=je[0],Ie=je[1],Pe=Object(l.useState)("crc"),Se=Object(s.a)(Pe,2),Ne=Se[0],we=Se[1],Fe=Object(l.useState)(!1),Te=Object(s.a)(Fe,2),ze=Te[0],Ae=Te[1],Re=Object(l.useState)(!1),Le=Object(s.a)(Re,2),Je=Le[0],De=Le[1],Ge=function(e,t,a){var l=Object(r.a)({},e);if(g)switch(F){case"sourcePlaylist":l.core_path=t.playlist.default_core_path,l.core_name=t.playlist.default_core_name;break;case"targetPlaylist":l.core_path=a.playlist.default_core_path,l.core_name=a.playlist.default_core_name;break;case"detect":l.core_path="DETECT",l.core_name="DETECT"}if(x&&e.path&&e.label===R){var n=e.path.match(/([^\\#]+)\....$/);n.length>1&&(l.label=n[1])}if(I&&e.path){var i=e.path.match(/([^\\]+\....)$/);i.length>1&&(l.path="".concat(G).concat(i[1]))}a.add(l)},$e=function(a,l){e.filter(a,l),t.filter(a,l)},Be={Reset:e.empty.bind(e),"Copy all":function(){e.playlist&&(e.playlist.items.forEach((function(a){Ge(a,e,t)})),t.filter(f,c))}},Me=function(e,t){var a="";switch(t){case"label":a=e.label;break;case"crc":a=e.crc32;break;case"basePath":if(e.path){var l=e.path.match(/(.+?)[^\\]+\....$/);l.length>1&&(a=l[1])}}return a},We=function(e,t,a){var l=Object(r.a)({},e);if(W)switch(ce){case"sourcePlaylist":l.core_path=t.playlist.default_core_path,l.core_name=t.playlist.default_core_name;break;case"targetPlaylist":l.core_path=a.playlist.default_core_path,l.core_name=a.playlist.default_core_name;break;case"detect":l.core_path="DETECT",l.core_name="DETECT"}if(ve&&l.path){var n=e.path.match(/([^\\#]+)\....$/);n.length>1&&(l.label=n[1])}if(V&&(l.label="".concat(l.label).concat(ke)),ae&&l.path){var i=l.path.match(/([^\\]+\....)$/);i.length>1&&(l.path="".concat(Ce).concat(i[1]))}return l},Xe={Reset:t.empty.bind(t),New:function(){t.set(t.getEmptyPlaylist(),"New Retroarch playlist.lpl")},"Fix visible":function(){var a;switch(Ne){case"label":a=t.filteredItems.filter((function(e){return!Y||Me(e.game,ue)===pe})).map((function(e){return e.game.label}));break;case"filename":a=t.filteredItems.filter((function(e){return!Y||Me(e.game,ue)===pe})).map((function(e){return e.game.path.match(/([^\\#]+\....)$/)[1]}));break;case"crc":a=t.filteredItems.filter((function(e){return!Y||Me(e.game,ue)===pe})).map((function(e){return e.game.crc32}));break;case"fullpath":a=t.filteredItems.filter((function(e){return!Y||Me(e.game,ue)===pe})).map((function(e){return e.game.path}));break;default:a=[]}a.forEach((function(a){switch(Ne){case"label":if(e.fullLabel[a]&&1===e.fullLabel[a].length){for(;t.fullLabel[a]&&t.fullLabel[a].length>0;)t.delete(t.fullLabel[a][0].index);t.add(We(e.fullLabel[a][0].game),e,t)}break;case"filename":if(e.fullFilename[a]&&1===e.fullFilename[a].length){for(;t.fullFilename[a]&&t.fullFilename[a].length>0;)t.delete(t.fullFilename[a][0].index);t.add(We(e.fullFilename[a][0].game,e,t))}break;case"crc":if(e.fullCrc[a]&&1===e.fullCrc[a].length){for(;t.fullCrc[a]&&t.fullCrc[a].length>0;)t.delete(t.fullCrc[a][0].index);t.add(We(e.fullCrc[a][0].game,e,t))}break;case"fullpath":if(e.fullPath[a]&&1===e.fullPath[a].length){for(;t.fullPath[a]&&t.fullPath[a].length>0;)t.delete(t.fullPath[a][0].index);t.add(We(e.fullPath[a][0].game,e,t))}}}))},Export:t.exportPlaylist.bind(t)};return n.a.createElement("div",{className:u.a.App},n.a.createElement("header",{className:u.a.header},n.a.createElement("h1",{className:u.a.title},"Retroarch playlist mixer")),n.a.createElement("div",{className:u.a.playlistPanel},n.a.createElement(P,{controller:y,onGameClick:function(a,l){t.playlist&&(Ge(a,e,t),t.filter(f,c))},buttons:Be}),n.a.createElement(P,{controller:E,onGameClick:function(e,a){t.delete(a),t.filter(f,c)},buttons:Xe})),n.a.createElement("div",null,n.a.createElement("h4",{onClick:function(){Ae(!ze)}},"(",ze?"-":"+",")When copying:"),ze?n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:g,onChange:function(e){v(e.target.checked)}}),"Change core name and path to ",n.a.createElement("select",{value:F,onChange:function(e){T(e.target.value)}},n.a.createElement("option",{value:"sourcePlaylist"},"Source Playlist default core"),n.a.createElement("option",{value:"targetPlaylist"},"Target Playlist default core"),n.a.createElement("option",{value:"detect"},"DETECT"))),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:x,onChange:function(e){O(e.target.checked)}}),"If label is ",n.a.createElement("input",{type:"text",value:R,onChange:function(e){L(e.target.value)}}),", deduce label from filename"),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:I,onChange:function(e){S(e.target.checked)}}),"change base path to ",n.a.createElement("input",{type:"text",value:G,onChange:function(e){$(e.target.value)}}))):null,n.a.createElement("h4",{onClick:function(){De(!Je)}},"(",Je?"-":"+",")When fixing:"),Je?n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:!0,disabled:!0}),"Match to source on ",n.a.createElement("select",{value:Ne,onChange:function(e){we(e.target.value)}},n.a.createElement("option",{value:"label"},"Label"),n.a.createElement("option",{value:"crc"},"CRC"),n.a.createElement("option",{value:"filename"},"Filename"),n.a.createElement("option",{value:"fullpath"},"Full path"))),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:W,onChange:function(e){X(e.target.checked)}}),"Change core name/path to ",n.a.createElement("select",{value:ce,onChange:function(e){re(e.target.value)}},n.a.createElement("option",{value:"sourcePlaylist"},"Source Playlist default core"),n.a.createElement("option",{value:"targetPlaylist"},"Target Playlist default core"),n.a.createElement("option",{value:"detect"},"DETECT"))),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:Y,onChange:function(e){H(e.target.checked)}}),"pick only entries with ",n.a.createElement("select",{value:ue,onChange:function(e){he(e.target.value)}},n.a.createElement("option",{value:"label"},"label"),n.a.createElement("option",{value:"crc"},"crc"),n.a.createElement("option",{value:"basePath"},"base path"))," matching ",n.a.createElement("input",{type:"text",value:pe,onChange:function(e){be(e.target.value)}})),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:ve,onChange:function(e){ye(e.target.checked)}}),"Deduce label from filename"),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:V,onChange:function(e){Z(e.target.checked)}}),"Append ",n.a.createElement("input",{type:"text",value:ke,onChange:function(e){xe(e.target.value)}})," to label"),n.a.createElement("li",null,n.a.createElement("input",{type:"checkbox",checked:ae,onChange:function(e){le(e.target.checked)}}),"change base path to ",n.a.createElement("input",{type:"text",value:Ce,onChange:function(e){Ie(e)}}))):null),n.a.createElement("div",{className:u.a.textPanel},n.a.createElement("div",{className:u.a.filter},"Filter visible by ",n.a.createElement("input",{onChange:function(e){o(e.target.value),$e(f,e.target.value)},value:c,className:u.a.filterText}),n.a.createElement("select",{value:f,onChange:function(e){p(e.target.value),""!==c&&$e(e.target.value,c)}},n.a.createElement("option",{value:"label"},"Label"),n.a.createElement("option",{value:"filename"},"Filename"),n.a.createElement("option",{value:"crc32"},"CRC32"),n.a.createElement("option",{value:"path"},"Full path")),n.a.createElement("button",{onClick:function(){o(""),$e(f,"")}},"clear")),n.a.createElement("textarea",{rows:"6",disabled:!0,value:"console"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},3:function(e,t,a){e.exports={container:"Game_container__1FRtk",label:"Game_label__3Xfiz",path:"Game_path__3ACC7",crc32:"Game_crc32__26Bi1",dbName:"Game_dbName__slKDc",core:"Game_core__3hxuS",coreName:"Game_coreName__1Af_M",corePath:"Game_corePath__3Riq4"}},4:function(e,t,a){e.exports={title:"App_title__1Eui0",App:"App_App__3xJ5q",header:"App_header__1FxIt",playlistPanel:"App_playlistPanel__fAtzO",textPanel:"App_textPanel__1ksXY",filter:"App_filter__2rpJO",filterText:"App_filterText__rjA92"}},6:function(e,t,a){e.exports={wrap:"Playlist_wrap__25CD4",content:"Playlist_content__3q2tv",buttonPanel:"Playlist_buttonPanel__1XzPe",filename:"Playlist_filename__3TaF-",dropzone:"Playlist_dropzone__3jSaX",dropzoneTitle:"Playlist_dropzoneTitle__MvR8x"}}},[[19,1,2]]]);
//# sourceMappingURL=main.252dc7a7.chunk.js.map