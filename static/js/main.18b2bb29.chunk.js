(this["webpackJsonpretroarch-playlist-mixer"]=this["webpackJsonpretroarch-playlist-mixer"]||[]).push([[0],{18:function(e,t,a){e.exports=a(27)},2:function(e,t,a){e.exports={container:"Game_container__1FRtk",label:"Game_label__3Xfiz",path:"Game_path__3ACC7",crc32:"Game_crc32__26Bi1",dbName:"Game_dbName__slKDc",core:"Game_core__3hxuS",coreName:"Game_coreName__1Af_M",corePath:"Game_corePath__3Riq4"}},23:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(11),s=a.n(i),r=(a(23),a(5)),c=a(4),o=a.n(c),m=a(17),u=a(8),h=a(12),p=a(13),f=a(3),d={version:"1.2",default_core_path:"",default_core_name:"",label_display_mode:0,right_thumbnail_mode:0,left_thumbnail_mode:0,items:[]},_=function(){function e(){Object(h.a)(this,e),this.playlist=null,this.filteredItems=null,this.filename=null,this.nameIndex={},this.crcIndex={},this.pathIndex={},this.playlistEvents=new f.a,this.filteredItemsEvents=new f.a,this.filenameEvents=new f.a}return Object(p.a)(e,[{key:"getPlaylistEvents",value:function(){return this.playlistEvents}},{key:"getfilteredItemsEvents",value:function(){return this.filteredItemsEvents}},{key:"getFilenameEvents",value:function(){return this.filenameEvents}},{key:"getEmptyPlaylist",value:function(){return JSON.parse(JSON.stringify(d))}},{key:"tokenize",value:function(e){return Object(u.a)(new Set(e.toLowerCase().match(/[a-z0-9]+/g).map((function(e){return e.split("").map((function(t,a){return e.slice(a)})).map((function(e){return e.split("").map((function(t,a){return e.slice(0,a+1)}))}))})).flat(2)))}},{key:"storeInRefs",value:function(e,t,a,n){t.forEach((function(t){return e[t]?e[t].push({index:n,game:a}):e[t]=[{index:n,game:a}]}))}},{key:"index",value:function(){var e=this;this.playlist&&this.playlist.items&&(this.nameIndex={},this.crcIndex={},this.pathIndex={},this.filenameIndex={},this.playlist.items.forEach((function(t,a){if(t.label&&e.storeInRefs(e.nameIndex,e.tokenize(t.label),t,a),t.crc32){var n=t.crc32.toLowerCase().match(/^[a-z0-9]+/);n.length>0&&e.storeInRefs(e.crcIndex,e.tokenize(n[0]),t,a)}t.path&&t.path.length>0&&(e.storeInRefs(e.pathIndex,e.tokenize(t.path),t,a),e.storeInRefs(e.filenameIndex,e.tokenize(t.path.match(/([^\\#]+)\....$/)[1]),t,a))})))}},{key:"applyFilter",value:function(e,t){var a=this;this.filteredItems=[],t.forEach((function(t){e[t]&&(a.filteredItems.length>0?a.filteredItems=a.filteredItems.filter((function(a){return e[t].filter((function(e){return a.index===e.index})).length>0})):a.filteredItems=Object(u.a)(e[t]))})),this.filteredItems=this.filteredItems.map((function(e){return e.index})),this.filteredItems=Object(u.a)(new Set(this.filteredItems)),this.filteredItems=this.filteredItems.map((function(e){return{game:a.playlist.items[e],index:e}}))}},{key:"filter",value:function(e,t){var a=t.toLowerCase().match(/[a-z0-9]+/g)||[];if(this.playlist&&this.playlist.items){if(a.length>0)switch(e){case"label":this.applyFilter(this.nameIndex,a);break;case"crc32":this.applyFilter(this.crcIndex,a);break;case"path":this.applyFilter(this.pathIndex,a);break;case"filename":this.applyFilter(this.filenameIndex,a)}else this.filteredItems=this.playlist.items.map((function(e,t){return{index:t,game:e}}));this.filteredItemsEvents.publish(Object(u.a)(this.filteredItems))}}},{key:"publish",value:function(){this.filenameEvents.publish(this.filename),this.playlistEvents.publish(this.playlist),this.filteredItemsEvents.publish(this.filteredItems)}},{key:"empty",value:function(){this.playlist=null,this.filteredItems=null,this.filename=null,this.publish()}},{key:"set",value:function(e,t){this.filename=t,this.playlist=JSON.parse(JSON.stringify(e)),this.index(),this.filter("label",""),this.publish()}},{key:"add",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist)),this.playlist.items.push(Object(m.a)({},e)),this.index(),this.filter("label",""),this.publish()}},{key:"delete",value:function(e){this.playlist=JSON.parse(JSON.stringify(this.playlist)),this.playlist.items.splice(e,1),this.index(),this.filter("label",""),this.publish()}}]),e}(),b=Object(n.createContext)(new _),v=Object(n.createContext)(new _),y=a(16),E=a(15),x=a.n(E),g=a(6),I=a.n(g),k=a(2),N=a.n(k),O=function(e){var t=e.path,a=e.label,n=e.core_path,i=e.core_name,s=e.crc32,r=e.db_name;return l.a.createElement("div",{className:N.a.container,onClick:e.onClick},l.a.createElement("div",{className:N.a.label},a),l.a.createElement("div",{className:N.a.path},t),l.a.createElement("div",{className:N.a.crc32},s),l.a.createElement("div",{className:N.a.dbName},r),l.a.createElement("div",{className:N.a.core},l.a.createElement("div",{className:N.a.coreName},"".concat(i,": ")),l.a.createElement("div",{className:N.a.corePath},n)))},j=function(e){var t=Object(n.useContext)(e.controller),a=Object(f.b)(null,t.getPlaylistEvents()),i=Object(r.a)(a,1)[0],s=Object(f.b)(null,t.getfilteredItemsEvents()),c=Object(r.a)(s,1)[0],o=Object(f.b)(null,t.getFilenameEvents()),m=Object(r.a)(o,1)[0],u=Object(n.useCallback)((function(e){if(e&&e.length>0){var a=e[0],n=new FileReader;n.onabort=function(){return console.log("file reading was aborted")},n.onerror=function(){return console.log("file reading has failed")},n.onload=function(){var e=n.result;t.set(JSON.parse(e),a.path)},n.readAsText(a)}}),[t]),h=Object(y.a)({onDrop:u}),p=h.getRootProps,d=h.getInputProps;return l.a.createElement("div",{className:"".concat(e.className?e.className+" ":"").concat(I.a.wrap)},l.a.createElement("div",{className:I.a.filename},m),l.a.createElement("div",{className:I.a.content},c?c.map((function(t){return l.a.createElement(O,{onClick:function(){return e.onGameClick(t.game,t.index)},key:t.index,path:t.game.path,label:t.game.label,core_path:t.game.core_path,core_name:t.game.core_name,crc32:t.game.crc32,db_name:t.game.db_names})})):l.a.createElement("div",Object.assign({},p(),{className:I.a.dropzone}),l.a.createElement("input",d()),l.a.createElement("div",{className:I.a.dropzoneTitle},"Drop playlist here!"))),l.a.createElement("div",{className:I.a.buttonPanel},l.a.createElement("button",{onClick:t.empty.bind(t)},"reset"),l.a.createElement("button",{onClick:function(){!function(e,t){var a=new Blob([e],{type:"text/plain;charset=utf-8"});x.a.saveAs(a,t)}(JSON.stringify(i,null,2),m)}},"export")))},w=function(){var e=Object(n.useContext)(b),t=Object(n.useContext)(v),a=Object(n.useState)(""),i=Object(r.a)(a,2),s=i[0],c=i[1],m=Object(n.useState)("label"),u=Object(r.a)(m,2),h=u[0],p=u[1],f=function(a,n){e.filter(a,n),t.filter(a,n)};return l.a.createElement("div",{className:o.a.App},l.a.createElement("header",{className:o.a.header},l.a.createElement("h1",{className:o.a.title},"Retroarch playlist mixer")),l.a.createElement("div",{className:o.a.playlistPanel},l.a.createElement(j,{controller:b,onGameClick:function(e,a){t.add(e),t.filter("label",s)}}),l.a.createElement(j,{controller:v,onGameClick:function(e,a){t.delete(a),t.filter("label",s)}})),l.a.createElement("div",{className:o.a.textPanel},l.a.createElement("div",{className:o.a.filter},l.a.createElement("input",{onChange:function(e){c(e.target.value),f(h,e.target.value)},value:s,className:o.a.filterText}),l.a.createElement("select",{value:h,onChange:function(e){p(e.target.value),""!=s&&f(e.target.value,s)}},l.a.createElement("option",{value:"label"},"Label"),l.a.createElement("option",{value:"crc32"},"CRC32"),l.a.createElement("option",{value:"path"},"Full path"),l.a.createElement("option",{value:"filename"},"Filename")),l.a.createElement("button",{onClick:function(){c(""),e.filter("label",""),t.filter("label","")}},"clear")),l.a.createElement("textarea",{rows:"6",disabled:!0,value:"console"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},4:function(e,t,a){e.exports={title:"App_title__1Eui0",App:"App_App__3xJ5q",header:"App_header__1FxIt",playlistPanel:"App_playlistPanel__fAtzO",textPanel:"App_textPanel__1ksXY",filter:"App_filter__2rpJO",filterText:"App_filterText__rjA92"}},6:function(e,t,a){e.exports={wrap:"Playlist_wrap__25CD4",content:"Playlist_content__3q2tv",buttonPanel:"Playlist_buttonPanel__1XzPe",filename:"Playlist_filename__3TaF-",dropzone:"Playlist_dropzone__3jSaX",dropzoneTitle:"Playlist_dropzoneTitle__MvR8x"}}},[[18,1,2]]]);
//# sourceMappingURL=main.18b2bb29.chunk.js.map